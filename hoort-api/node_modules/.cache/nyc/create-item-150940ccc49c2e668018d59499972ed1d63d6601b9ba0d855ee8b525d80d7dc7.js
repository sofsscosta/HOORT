function cov_114ersgnvb(){var path="/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/create-item.js";var hash="d8fba23e2aa61865e4e7ab592677389bed691596";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/create-item.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:43}},"1":{start:{line:2,column:35},end:{line:2,column:56}},"2":{start:{line:3,column:28},end:{line:3,column:57}},"3":{start:{line:6,column:0},end:{line:33,column:1}},"4":{start:{line:8,column:4},end:{line:8,column:39}},"5":{start:{line:9,column:4},end:{line:9,column:33}},"6":{start:{line:10,column:4},end:{line:10,column:33}},"7":{start:{line:11,column:4},end:{line:11,column:39}},"8":{start:{line:12,column:4},end:{line:12,column:37}},"9":{start:{line:13,column:4},end:{line:13,column:53}},"10":{start:{line:14,column:4},end:{line:14,column:33}},"11":{start:{line:15,column:4},end:{line:15,column:47}},"12":{start:{line:16,column:4},end:{line:16,column:45}},"13":{start:{line:17,column:4},end:{line:17,column:47}},"14":{start:{line:18,column:4},end:{line:18,column:55}},"15":{start:{line:23,column:4},end:{line:32,column:24}},"16":{start:{line:25,column:12},end:{line:30,column:13}},"17":{start:{line:25,column:22},end:{line:25,column:88}},"18":{start:{line:28,column:16},end:{line:28,column:152}},"19":{start:{line:29,column:16},end:{line:29,column:34}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:17},end:{line:6,column:18}},loc:{start:{line:6,column:138},end:{line:33,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:24,column:14},end:{line:24,column:15}},loc:{start:{line:24,column:22},end:{line:31,column:9}},line:24},"2":{name:"(anonymous_2)",decl:{start:{line:32,column:14},end:{line:32,column:15}},loc:{start:{line:32,column:20},end:{line:32,column:23}},line:32}},branchMap:{"0":{loc:{start:{line:25,column:12},end:{line:30,column:13}},type:"if",locations:[{start:{line:25,column:12},end:{line:30,column:13}},{start:{line:25,column:12},end:{line:30,column:13}}],line:25}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"d8fba23e2aa61865e4e7ab592677389bed691596"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_114ersgnvb=function(){return actualCoverage;};return actualCoverage;}cov_114ersgnvb();const{validate}=(cov_114ersgnvb().s[0]++,require('hoort-utils'));const{models:{Land,Item}}=(cov_114ersgnvb().s[1]++,require('hoort-data'));const{NotAllowedError}=(cov_114ersgnvb().s[2]++,require('../../hoort-errors'));// TODO add userId parameter
cov_114ersgnvb().s[3]++;module.exports=(colorId,name,type,subtype,growth,growthDuration,soil,temperature,bestPeriod,bestPeriodNum,lightPreference)=>{cov_114ersgnvb().f[0]++;cov_114ersgnvb().s[4]++;validate.string(colorId,'colorId');cov_114ersgnvb().s[5]++;validate.string(name,'name');cov_114ersgnvb().s[6]++;validate.string(type,'type');cov_114ersgnvb().s[7]++;validate.string(subtype,'subtype');cov_114ersgnvb().s[8]++;validate.string(growth,'growth');cov_114ersgnvb().s[9]++;validate.string(growthDuration,'growthDuration');cov_114ersgnvb().s[10]++;validate.string(soil,'soil');cov_114ersgnvb().s[11]++;validate.string(temperature,'temperature');cov_114ersgnvb().s[12]++;validate.string(bestPeriod,'bestPeriod');cov_114ersgnvb().s[13]++;validate.array(bestPeriodNum,'bestPeriod');cov_114ersgnvb().s[14]++;validate.string(lightPreference,'lightPreference');// TODO find user by id (userId)
// TODO check user exists and user role === 'admin', othwerwise throw error
cov_114ersgnvb().s[15]++;return Item.findOne({name}).then(item=>{cov_114ersgnvb().f[1]++;cov_114ersgnvb().s[16]++;if(item){cov_114ersgnvb().b[0][0]++;cov_114ersgnvb().s[17]++;throw new NotAllowedError(`item with name ${name} already exists`);}else{cov_114ersgnvb().b[0][1]++;cov_114ersgnvb().s[18]++;item=new Item({colorId,name,type,subtype,growth,growthDuration,soil,temperature,bestPeriod,bestPeriodNum,lightPreference});cov_114ersgnvb().s[19]++;return item.save();}}).then(()=>{cov_114ersgnvb().f[2]++;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZS1pdGVtLmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlIiwicmVxdWlyZSIsIm1vZGVscyIsIkxhbmQiLCJJdGVtIiwiTm90QWxsb3dlZEVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyIsImNvbG9ySWQiLCJuYW1lIiwidHlwZSIsInN1YnR5cGUiLCJncm93dGgiLCJncm93dGhEdXJhdGlvbiIsInNvaWwiLCJ0ZW1wZXJhdHVyZSIsImJlc3RQZXJpb2QiLCJiZXN0UGVyaW9kTnVtIiwibGlnaHRQcmVmZXJlbmNlIiwic3RyaW5nIiwiYXJyYXkiLCJmaW5kT25lIiwidGhlbiIsIml0ZW0iLCJzYXZlIl0sIm1hcHBpbmdzIjoiNG5GQUFBLEtBQU0sQ0FBRUEsUUFBRiwyQkFBZUMsT0FBTyxDQUFDLGFBQUQsQ0FBdEIsQ0FBTixDQUNBLEtBQU0sQ0FBRUMsTUFBTSxDQUFFLENBQUVDLElBQUYsQ0FBUUMsSUFBUixDQUFWLDJCQUE2QkgsT0FBTyxDQUFDLFlBQUQsQ0FBcEMsQ0FBTixDQUNBLEtBQU0sQ0FBRUksZUFBRiwyQkFBc0JKLE9BQU8sQ0FBQyxvQkFBRCxDQUE3QixDQUFOLENBRUE7d0JBQ0FLLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUFDQyxPQUFELENBQVVDLElBQVYsQ0FBZ0JDLElBQWhCLENBQXNCQyxPQUF0QixDQUErQkMsTUFBL0IsQ0FBdUNDLGNBQXZDLENBQXVEQyxJQUF2RCxDQUE2REMsV0FBN0QsQ0FBMEVDLFVBQTFFLENBQXNGQyxhQUF0RixDQUFxR0MsZUFBckcsR0FBeUgsaURBRXRJbEIsUUFBUSxDQUFDbUIsTUFBVCxDQUFnQlgsT0FBaEIsQ0FBeUIsU0FBekIsRUFGc0ksd0JBR3RJUixRQUFRLENBQUNtQixNQUFULENBQWdCVixJQUFoQixDQUFzQixNQUF0QixFQUhzSSx3QkFJdElULFFBQVEsQ0FBQ21CLE1BQVQsQ0FBZ0JULElBQWhCLENBQXNCLE1BQXRCLEVBSnNJLHdCQUt0SVYsUUFBUSxDQUFDbUIsTUFBVCxDQUFnQlIsT0FBaEIsQ0FBeUIsU0FBekIsRUFMc0ksd0JBTXRJWCxRQUFRLENBQUNtQixNQUFULENBQWdCUCxNQUFoQixDQUF3QixRQUF4QixFQU5zSSx3QkFPdElaLFFBQVEsQ0FBQ21CLE1BQVQsQ0FBZ0JOLGNBQWhCLENBQWdDLGdCQUFoQyxFQVBzSSx5QkFRdEliLFFBQVEsQ0FBQ21CLE1BQVQsQ0FBZ0JMLElBQWhCLENBQXNCLE1BQXRCLEVBUnNJLHlCQVN0SWQsUUFBUSxDQUFDbUIsTUFBVCxDQUFnQkosV0FBaEIsQ0FBNkIsYUFBN0IsRUFUc0kseUJBVXRJZixRQUFRLENBQUNtQixNQUFULENBQWdCSCxVQUFoQixDQUE0QixZQUE1QixFQVZzSSx5QkFXdEloQixRQUFRLENBQUNvQixLQUFULENBQWVILGFBQWYsQ0FBOEIsWUFBOUIsRUFYc0kseUJBWXRJakIsUUFBUSxDQUFDbUIsTUFBVCxDQUFnQkQsZUFBaEIsQ0FBaUMsaUJBQWpDLEVBRUE7QUFDQTtBQWZzSSx5QkFpQnRJLE1BQU9kLENBQUFBLElBQUksQ0FBQ2lCLE9BQUwsQ0FBYSxDQUFFWixJQUFGLENBQWIsRUFDRmEsSUFERSxDQUNHQyxJQUFJLEVBQUksa0RBQ1YsR0FBSUEsSUFBSixDQUFVLDBEQUFNLElBQUlsQixDQUFBQSxlQUFKLENBQXFCLGtCQUFpQkksSUFBSyxpQkFBM0MsQ0FBTixDQUFrRSxDQUE1RSxJQUVLLHFEQUNEYyxJQUFJLENBQUcsR0FBSW5CLENBQUFBLElBQUosQ0FBUyxDQUFFSSxPQUFGLENBQVdDLElBQVgsQ0FBaUJDLElBQWpCLENBQXVCQyxPQUF2QixDQUFnQ0MsTUFBaEMsQ0FBd0NDLGNBQXhDLENBQXdEQyxJQUF4RCxDQUE4REMsV0FBOUQsQ0FBMkVDLFVBQTNFLENBQXVGQyxhQUF2RixDQUFzR0MsZUFBdEcsQ0FBVCxDQUFQLENBREMseUJBRUQsTUFBT0ssQ0FBQUEsSUFBSSxDQUFDQyxJQUFMLEVBQVAsQ0FDSCxDQUNKLENBUkUsRUFTRkYsSUFURSxDQVNHLElBQU0seUJBQUcsQ0FUWixDQUFQLENBVUgsQ0EzQkQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IHZhbGlkYXRlIH0gPSByZXF1aXJlKCdob29ydC11dGlscycpXG5jb25zdCB7IG1vZGVsczogeyBMYW5kLCBJdGVtIH0gfSA9IHJlcXVpcmUoJ2hvb3J0LWRhdGEnKVxuY29uc3QgeyBOb3RBbGxvd2VkRXJyb3IgfSA9IHJlcXVpcmUoJy4uLy4uL2hvb3J0LWVycm9ycycpXG5cbi8vIFRPRE8gYWRkIHVzZXJJZCBwYXJhbWV0ZXJcbm1vZHVsZS5leHBvcnRzID0gKGNvbG9ySWQsIG5hbWUsIHR5cGUsIHN1YnR5cGUsIGdyb3d0aCwgZ3Jvd3RoRHVyYXRpb24sIHNvaWwsIHRlbXBlcmF0dXJlLCBiZXN0UGVyaW9kLCBiZXN0UGVyaW9kTnVtLCBsaWdodFByZWZlcmVuY2UpID0+IHtcblxuICAgIHZhbGlkYXRlLnN0cmluZyhjb2xvcklkLCAnY29sb3JJZCcpXG4gICAgdmFsaWRhdGUuc3RyaW5nKG5hbWUsICduYW1lJylcbiAgICB2YWxpZGF0ZS5zdHJpbmcodHlwZSwgJ3R5cGUnKVxuICAgIHZhbGlkYXRlLnN0cmluZyhzdWJ0eXBlLCAnc3VidHlwZScpXG4gICAgdmFsaWRhdGUuc3RyaW5nKGdyb3d0aCwgJ2dyb3d0aCcpXG4gICAgdmFsaWRhdGUuc3RyaW5nKGdyb3d0aER1cmF0aW9uLCAnZ3Jvd3RoRHVyYXRpb24nKVxuICAgIHZhbGlkYXRlLnN0cmluZyhzb2lsLCAnc29pbCcpXG4gICAgdmFsaWRhdGUuc3RyaW5nKHRlbXBlcmF0dXJlLCAndGVtcGVyYXR1cmUnKVxuICAgIHZhbGlkYXRlLnN0cmluZyhiZXN0UGVyaW9kLCAnYmVzdFBlcmlvZCcpXG4gICAgdmFsaWRhdGUuYXJyYXkoYmVzdFBlcmlvZE51bSwgJ2Jlc3RQZXJpb2QnKVxuICAgIHZhbGlkYXRlLnN0cmluZyhsaWdodFByZWZlcmVuY2UsICdsaWdodFByZWZlcmVuY2UnKVxuXG4gICAgLy8gVE9ETyBmaW5kIHVzZXIgYnkgaWQgKHVzZXJJZClcbiAgICAvLyBUT0RPIGNoZWNrIHVzZXIgZXhpc3RzIGFuZCB1c2VyIHJvbGUgPT09ICdhZG1pbicsIG90aHdlcndpc2UgdGhyb3cgZXJyb3JcblxuICAgIHJldHVybiBJdGVtLmZpbmRPbmUoeyBuYW1lIH0pXG4gICAgICAgIC50aGVuKGl0ZW0gPT4ge1xuICAgICAgICAgICAgaWYgKGl0ZW0pIHRocm93IG5ldyBOb3RBbGxvd2VkRXJyb3IoYGl0ZW0gd2l0aCBuYW1lICR7bmFtZX0gYWxyZWFkeSBleGlzdHNgKVxuXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpdGVtID0gbmV3IEl0ZW0oeyBjb2xvcklkLCBuYW1lLCB0eXBlLCBzdWJ0eXBlLCBncm93dGgsIGdyb3d0aER1cmF0aW9uLCBzb2lsLCB0ZW1wZXJhdHVyZSwgYmVzdFBlcmlvZCwgYmVzdFBlcmlvZE51bSwgbGlnaHRQcmVmZXJlbmNlIH0pXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uc2F2ZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKCgpID0+IHsgfSlcbn0iXX0=