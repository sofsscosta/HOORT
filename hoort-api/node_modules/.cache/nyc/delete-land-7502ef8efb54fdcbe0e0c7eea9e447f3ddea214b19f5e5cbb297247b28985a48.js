function cov_pae2ofir9(){var path="/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/delete-land.js";var hash="88989c7631a6ee39ddb514fc19ace361a59137fe";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/delete-land.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:43}},"1":{start:{line:2,column:35},end:{line:2,column:56}},"2":{start:{line:3,column:28},end:{line:3,column:57}},"3":{start:{line:4,column:38},end:{line:4,column:57}},"4":{start:{line:6,column:0},end:{line:21,column:1}},"5":{start:{line:8,column:4},end:{line:8,column:29}},"6":{start:{line:9,column:4},end:{line:9,column:37}},"7":{start:{line:11,column:4},end:{line:20,column:24}},"8":{start:{line:15,column:12},end:{line:15,column:113}},"9":{start:{line:15,column:47},end:{line:15,column:113}},"10":{start:{line:17,column:12},end:{line:17,column:49}},"11":{start:{line:19,column:20},end:{line:19,column:76}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:17},end:{line:6,column:18}},loc:{start:{line:6,column:33},end:{line:21,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:12,column:14},end:{line:12,column:15}},loc:{start:{line:12,column:22},end:{line:18,column:9}},line:12},"2":{name:"(anonymous_2)",decl:{start:{line:19,column:14},end:{line:19,column:15}},loc:{start:{line:19,column:20},end:{line:19,column:76}},line:19},"3":{name:"(anonymous_3)",decl:{start:{line:20,column:14},end:{line:20,column:15}},loc:{start:{line:20,column:20},end:{line:20,column:23}},line:20}},branchMap:{"0":{loc:{start:{line:15,column:12},end:{line:15,column:113}},type:"if",locations:[{start:{line:15,column:12},end:{line:15,column:113}},{start:{line:15,column:12},end:{line:15,column:113}}],line:15}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"88989c7631a6ee39ddb514fc19ace361a59137fe"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_pae2ofir9=function(){return actualCoverage;};return actualCoverage;}cov_pae2ofir9();const{validate}=(cov_pae2ofir9().s[0]++,require('hoort-utils'));const{models:{Land,User}}=(cov_pae2ofir9().s[1]++,require('hoort-data'));const{NotAllowedError}=(cov_pae2ofir9().s[2]++,require('../../hoort-errors'));const{SchemaTypes:{ObjectId}}=(cov_pae2ofir9().s[3]++,require('mongoose'));cov_pae2ofir9().s[4]++;module.exports=(id,landId)=>{cov_pae2ofir9().f[0]++;cov_pae2ofir9().s[5]++;validate.string(id,'id');cov_pae2ofir9().s[6]++;validate.string(landId,'landId');cov_pae2ofir9().s[7]++;return Land.findById(landId).then(land=>{cov_pae2ofir9().f[1]++;cov_pae2ofir9().s[8]++;// if (land instanceof Error) throw new NotAllowedError(`This land doesn't exist!`)
if(land.userId.toString()!==id){cov_pae2ofir9().b[0][0]++;cov_pae2ofir9().s[9]++;throw new NotAllowedError(`This land doesn't belong to this user`);}else{cov_pae2ofir9().b[0][1]++;}cov_pae2ofir9().s[10]++;return Land.findByIdAndDelete(landId);}).then(()=>{cov_pae2ofir9().f[2]++;cov_pae2ofir9().s[11]++;return User.findByIdAndUpdate(id,{$pull:{lands:landId}});}).then(()=>{cov_pae2ofir9().f[3]++;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlbGV0ZS1sYW5kLmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlIiwicmVxdWlyZSIsIm1vZGVscyIsIkxhbmQiLCJVc2VyIiwiTm90QWxsb3dlZEVycm9yIiwiU2NoZW1hVHlwZXMiLCJPYmplY3RJZCIsIm1vZHVsZSIsImV4cG9ydHMiLCJpZCIsImxhbmRJZCIsInN0cmluZyIsImZpbmRCeUlkIiwidGhlbiIsImxhbmQiLCJ1c2VySWQiLCJ0b1N0cmluZyIsImZpbmRCeUlkQW5kRGVsZXRlIiwiZmluZEJ5SWRBbmRVcGRhdGUiLCIkcHVsbCIsImxhbmRzIl0sIm1hcHBpbmdzIjoiNnhFQUFBLEtBQU0sQ0FBRUEsUUFBRiwwQkFBZUMsT0FBTyxDQUFDLGFBQUQsQ0FBdEIsQ0FBTixDQUNBLEtBQU0sQ0FBRUMsTUFBTSxDQUFFLENBQUVDLElBQUYsQ0FBUUMsSUFBUixDQUFWLDBCQUE2QkgsT0FBTyxDQUFDLFlBQUQsQ0FBcEMsQ0FBTixDQUNBLEtBQU0sQ0FBRUksZUFBRiwwQkFBc0JKLE9BQU8sQ0FBQyxvQkFBRCxDQUE3QixDQUFOLENBQ0EsS0FBTSxDQUFFSyxXQUFXLENBQUUsQ0FBRUMsUUFBRixDQUFmLDBCQUFnQ04sT0FBTyxDQUFDLFVBQUQsQ0FBdkMsQ0FBTixDLHVCQUVBTyxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsQ0FBQ0MsRUFBRCxDQUFLQyxNQUFMLEdBQWdCLCtDQUU3QlgsUUFBUSxDQUFDWSxNQUFULENBQWdCRixFQUFoQixDQUFvQixJQUFwQixFQUY2Qix1QkFHN0JWLFFBQVEsQ0FBQ1ksTUFBVCxDQUFnQkQsTUFBaEIsQ0FBd0IsUUFBeEIsRUFINkIsdUJBSzdCLE1BQU9SLENBQUFBLElBQUksQ0FBQ1UsUUFBTCxDQUFjRixNQUFkLEVBQ0ZHLElBREUsQ0FDR0MsSUFBSSxFQUFJLCtDQUNWO0FBRUEsR0FBSUEsSUFBSSxDQUFDQyxNQUFMLENBQVlDLFFBQVosS0FBMkJQLEVBQS9CLENBQW1DLHVEQUFNLElBQUlMLENBQUFBLGVBQUosQ0FBcUIsdUNBQXJCLENBQU4sQ0FBa0UsQ0FBckcsZ0NBSFUsd0JBS1YsTUFBT0YsQ0FBQUEsSUFBSSxDQUFDZSxpQkFBTCxDQUF1QlAsTUFBdkIsQ0FBUCxDQUNILENBUEUsRUFRRkcsSUFSRSxDQVFHLElBQU0sc0RBQUFWLENBQUFBLElBQUksQ0FBQ2UsaUJBQUwsQ0FBdUJULEVBQXZCLENBQTJCLENBQUVVLEtBQUssQ0FBRSxDQUFFQyxLQUFLLENBQUVWLE1BQVQsQ0FBVCxDQUEzQixFQUF3RCxDQVJqRSxFQVNGRyxJQVRFLENBU0csSUFBTSx3QkFBRyxDQVRaLENBQVAsQ0FVSCxDQWZEIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyB2YWxpZGF0ZSB9ID0gcmVxdWlyZSgnaG9vcnQtdXRpbHMnKVxuY29uc3QgeyBtb2RlbHM6IHsgTGFuZCwgVXNlciB9IH0gPSByZXF1aXJlKCdob29ydC1kYXRhJylcbmNvbnN0IHsgTm90QWxsb3dlZEVycm9yIH0gPSByZXF1aXJlKCcuLi8uLi9ob29ydC1lcnJvcnMnKVxuY29uc3QgeyBTY2hlbWFUeXBlczogeyBPYmplY3RJZCB9IH0gPSByZXF1aXJlKCdtb25nb29zZScpXG5cbm1vZHVsZS5leHBvcnRzID0gKGlkLCBsYW5kSWQpID0+IHtcblxuICAgIHZhbGlkYXRlLnN0cmluZyhpZCwgJ2lkJylcbiAgICB2YWxpZGF0ZS5zdHJpbmcobGFuZElkLCAnbGFuZElkJylcblxuICAgIHJldHVybiBMYW5kLmZpbmRCeUlkKGxhbmRJZClcbiAgICAgICAgLnRoZW4obGFuZCA9PiB7XG4gICAgICAgICAgICAvLyBpZiAobGFuZCBpbnN0YW5jZW9mIEVycm9yKSB0aHJvdyBuZXcgTm90QWxsb3dlZEVycm9yKGBUaGlzIGxhbmQgZG9lc24ndCBleGlzdCFgKVxuXG4gICAgICAgICAgICBpZiAobGFuZC51c2VySWQudG9TdHJpbmcoKSAhPT0gaWQpIHRocm93IG5ldyBOb3RBbGxvd2VkRXJyb3IoYFRoaXMgbGFuZCBkb2Vzbid0IGJlbG9uZyB0byB0aGlzIHVzZXJgKVxuXG4gICAgICAgICAgICByZXR1cm4gTGFuZC5maW5kQnlJZEFuZERlbGV0ZShsYW5kSWQpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKCgpID0+IFVzZXIuZmluZEJ5SWRBbmRVcGRhdGUoaWQsIHsgJHB1bGw6IHsgbGFuZHM6IGxhbmRJZCB9IH0pKVxuICAgICAgICAudGhlbigoKSA9PiB7IH0pXG59Il19