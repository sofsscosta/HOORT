function cov_2de82lipfu(){var path="/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/retrieve-land-plantations.js";var hash="df97b492b7adc5f378e3901df61adbf0894d8612";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/retrieve-land-plantations.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:43}},"1":{start:{line:2,column:35},end:{line:2,column:56}},"2":{start:{line:3,column:26},end:{line:3,column:55}},"3":{start:{line:4,column:15},end:{line:4,column:32}},"4":{start:{line:6,column:0},end:{line:31,column:1}},"5":{start:{line:7,column:4},end:{line:7,column:37}},"6":{start:{line:8,column:4},end:{line:8,column:37}},"7":{start:{line:10,column:15},end:{line:10,column:49}},"8":{start:{line:12,column:4},end:{line:12,column:58}},"9":{start:{line:12,column:15},end:{line:12,column:58}},"10":{start:{line:14,column:4},end:{line:14,column:74}},"11":{start:{line:14,column:26},end:{line:14,column:74}},"12":{start:{line:16,column:15},end:{line:16,column:42}},"13":{start:{line:18,column:4},end:{line:18,column:58}},"14":{start:{line:18,column:15},end:{line:18,column:58}},"15":{start:{line:20,column:4},end:{line:20,column:95}},"16":{start:{line:20,column:38},end:{line:20,column:95}},"17":{start:{line:22,column:4},end:{line:26,column:6}},"18":{start:{line:23,column:8},end:{line:23,column:29}},"19":{start:{line:24,column:8},end:{line:24,column:66}},"20":{start:{line:25,column:8},end:{line:25,column:70}},"21":{start:{line:28,column:4},end:{line:28,column:32}},"22":{start:{line:30,column:4},end:{line:30,column:26}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:17},end:{line:6,column:18}},loc:{start:{line:6,column:43},end:{line:31,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:28},end:{line:22,column:29}},loc:{start:{line:22,column:42},end:{line:26,column:5}},line:22}},branchMap:{"0":{loc:{start:{line:12,column:4},end:{line:12,column:58}},type:"if",locations:[{start:{line:12,column:4},end:{line:12,column:58}},{start:{line:12,column:4},end:{line:12,column:58}}],line:12},"1":{loc:{start:{line:14,column:4},end:{line:14,column:74}},type:"if",locations:[{start:{line:14,column:4},end:{line:14,column:74}},{start:{line:14,column:4},end:{line:14,column:74}}],line:14},"2":{loc:{start:{line:18,column:4},end:{line:18,column:58}},type:"if",locations:[{start:{line:18,column:4},end:{line:18,column:58}},{start:{line:18,column:4},end:{line:18,column:58}}],line:18},"3":{loc:{start:{line:20,column:4},end:{line:20,column:95}},type:"if",locations:[{start:{line:20,column:4},end:{line:20,column:95}},{start:{line:20,column:4},end:{line:20,column:95}}],line:20}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"df97b492b7adc5f378e3901df61adbf0894d8612"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_2de82lipfu=function(){return actualCoverage;};return actualCoverage;}cov_2de82lipfu();const{validate}=(cov_2de82lipfu().s[0]++,require('hoort-utils'));const{models:{Land,User}}=(cov_2de82lipfu().s[1]++,require('hoort-data'));const{NotFoundError}=(cov_2de82lipfu().s[2]++,require('../../hoort-errors'));const moment=(cov_2de82lipfu().s[3]++,require('moment'));cov_2de82lipfu().s[4]++;module.exports=async(userId,landId)=>{cov_2de82lipfu().f[0]++;cov_2de82lipfu().s[5]++;validate.string(userId,'userId');cov_2de82lipfu().s[6]++;validate.string(landId,'landId');let land=(cov_2de82lipfu().s[7]++,await Land.findById(landId).lean());cov_2de82lipfu().s[8]++;if(!land){cov_2de82lipfu().b[0][0]++;cov_2de82lipfu().s[9]++;throw new Error('This land doesn\'t exist');}else{cov_2de82lipfu().b[0][1]++;}cov_2de82lipfu().s[10]++;if(!land.plantation){cov_2de82lipfu().b[1][0]++;cov_2de82lipfu().s[11]++;throw new Error('This land isn\'t planted yet!');}else{cov_2de82lipfu().b[1][1]++;}let user=(cov_2de82lipfu().s[12]++,await User.findById(userId));cov_2de82lipfu().s[13]++;if(!user){cov_2de82lipfu().b[2][0]++;cov_2de82lipfu().s[14]++;throw new Error('This user doesn\'s exist');}else{cov_2de82lipfu().b[2][1]++;}cov_2de82lipfu().s[15]++;if(!user.lands.includes(landId)){cov_2de82lipfu().b[3][0]++;cov_2de82lipfu().s[16]++;throw new Error('This land doesn\'t belong to this user');}else{cov_2de82lipfu().b[3][1]++;}cov_2de82lipfu().s[17]++;land.plantation.forEach(plantation=>{cov_2de82lipfu().f[1]++;cov_2de82lipfu().s[18]++;delete plantation._id;cov_2de82lipfu().s[19]++;plantation.to=moment(plantation.to).format('YYYY-MM-DD');cov_2de82lipfu().s[20]++;plantation.from=moment(plantation.from).format('YYYY-MM-DD');});cov_2de82lipfu().s[21]++;console.log(land.plantation);cov_2de82lipfu().s[22]++;return land.plantation;};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpZXZlLWxhbmQtcGxhbnRhdGlvbnMuanMiXSwibmFtZXMiOlsidmFsaWRhdGUiLCJyZXF1aXJlIiwibW9kZWxzIiwiTGFuZCIsIlVzZXIiLCJOb3RGb3VuZEVycm9yIiwibW9tZW50IiwibW9kdWxlIiwiZXhwb3J0cyIsInVzZXJJZCIsImxhbmRJZCIsInN0cmluZyIsImxhbmQiLCJmaW5kQnlJZCIsImxlYW4iLCJFcnJvciIsInBsYW50YXRpb24iLCJ1c2VyIiwibGFuZHMiLCJpbmNsdWRlcyIsImZvckVhY2giLCJfaWQiLCJ0byIsImZvcm1hdCIsImZyb20iLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoidXhHQUFBLEtBQU0sQ0FBRUEsUUFBRiwyQkFBZUMsT0FBTyxDQUFDLGFBQUQsQ0FBdEIsQ0FBTixDQUNBLEtBQU0sQ0FBRUMsTUFBTSxDQUFFLENBQUVDLElBQUYsQ0FBUUMsSUFBUixDQUFWLDJCQUE2QkgsT0FBTyxDQUFDLFlBQUQsQ0FBcEMsQ0FBTixDQUNBLEtBQU0sQ0FBRUksYUFBRiwyQkFBb0JKLE9BQU8sQ0FBQyxvQkFBRCxDQUEzQixDQUFOLENBQ0EsS0FBTUssQ0FBQUEsTUFBTSwwQkFBR0wsT0FBTyxDQUFDLFFBQUQsQ0FBVixDQUFaLEMsd0JBRUFNLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixNQUFPQyxNQUFQLENBQWVDLE1BQWYsR0FBMEIsaURBQ3ZDVixRQUFRLENBQUNXLE1BQVQsQ0FBZ0JGLE1BQWhCLENBQXdCLFFBQXhCLEVBRHVDLHdCQUV2Q1QsUUFBUSxDQUFDVyxNQUFULENBQWdCRCxNQUFoQixDQUF3QixRQUF4QixFQUVBLEdBQUlFLENBQUFBLElBQUksMEJBQUcsS0FBTVQsQ0FBQUEsSUFBSSxDQUFDVSxRQUFMLENBQWNILE1BQWQsRUFBc0JJLElBQXRCLEVBQVQsQ0FBUixDQUp1Qyx3QkFNdkMsR0FBSSxDQUFDRixJQUFMLENBQVcseURBQU0sSUFBSUcsQ0FBQUEsS0FBSixDQUFVLDBCQUFWLENBQU4sQ0FBMkMsQ0FBdEQsaUNBTnVDLHlCQVF2QyxHQUFJLENBQUNILElBQUksQ0FBQ0ksVUFBVixDQUFzQiwwREFBTSxJQUFJRCxDQUFBQSxLQUFKLENBQVUsK0JBQVYsQ0FBTixDQUFnRCxDQUF0RSxpQ0FFQSxHQUFJRSxDQUFBQSxJQUFJLDJCQUFHLEtBQU1iLENBQUFBLElBQUksQ0FBQ1MsUUFBTCxDQUFjSixNQUFkLENBQVQsQ0FBUixDQVZ1Qyx5QkFZdkMsR0FBSSxDQUFDUSxJQUFMLENBQVcsMERBQU0sSUFBSUYsQ0FBQUEsS0FBSixDQUFVLDBCQUFWLENBQU4sQ0FBMkMsQ0FBdEQsaUNBWnVDLHlCQWN2QyxHQUFJLENBQUNFLElBQUksQ0FBQ0MsS0FBTCxDQUFXQyxRQUFYLENBQW9CVCxNQUFwQixDQUFMLENBQWtDLDBEQUFNLElBQUlLLENBQUFBLEtBQUosQ0FBVSx3Q0FBVixDQUFOLENBQXlELENBQTNGLGlDQWR1Qyx5QkFnQnZDSCxJQUFJLENBQUNJLFVBQUwsQ0FBZ0JJLE9BQWhCLENBQXdCSixVQUFVLEVBQUksa0RBQ2xDLE1BQU9BLENBQUFBLFVBQVUsQ0FBQ0ssR0FBbEIsQ0FEa0MseUJBRWxDTCxVQUFVLENBQUNNLEVBQVgsQ0FBZ0JoQixNQUFNLENBQUNVLFVBQVUsQ0FBQ00sRUFBWixDQUFOLENBQXNCQyxNQUF0QixDQUE2QixZQUE3QixDQUFoQixDQUZrQyx5QkFHbENQLFVBQVUsQ0FBQ1EsSUFBWCxDQUFrQmxCLE1BQU0sQ0FBQ1UsVUFBVSxDQUFDUSxJQUFaLENBQU4sQ0FBd0JELE1BQXhCLENBQStCLFlBQS9CLENBQWxCLENBQ0gsQ0FKRCxFQWhCdUMseUJBc0J2Q0UsT0FBTyxDQUFDQyxHQUFSLENBQVlkLElBQUksQ0FBQ0ksVUFBakIsRUF0QnVDLHlCQXdCdkMsTUFBT0osQ0FBQUEsSUFBSSxDQUFDSSxVQUFaLENBQ0gsQ0F6QkQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IHZhbGlkYXRlIH0gPSByZXF1aXJlKCdob29ydC11dGlscycpXG5jb25zdCB7IG1vZGVsczogeyBMYW5kLCBVc2VyIH0gfSA9IHJlcXVpcmUoJ2hvb3J0LWRhdGEnKVxuY29uc3QgeyBOb3RGb3VuZEVycm9yIH0gPSByZXF1aXJlKCcuLi8uLi9ob29ydC1lcnJvcnMnKVxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50JylcblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAodXNlcklkLCBsYW5kSWQpID0+IHtcbiAgICB2YWxpZGF0ZS5zdHJpbmcodXNlcklkLCAndXNlcklkJylcbiAgICB2YWxpZGF0ZS5zdHJpbmcobGFuZElkLCAnbGFuZElkJylcblxuICAgIGxldCBsYW5kID0gYXdhaXQgTGFuZC5maW5kQnlJZChsYW5kSWQpLmxlYW4oKVxuXG4gICAgaWYgKCFsYW5kKSB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbGFuZCBkb2VzblxcJ3QgZXhpc3QnKVxuXG4gICAgaWYgKCFsYW5kLnBsYW50YXRpb24pIHRocm93IG5ldyBFcnJvcignVGhpcyBsYW5kIGlzblxcJ3QgcGxhbnRlZCB5ZXQhJylcblxuICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZCh1c2VySWQpXG5cbiAgICBpZiAoIXVzZXIpIHRocm93IG5ldyBFcnJvcignVGhpcyB1c2VyIGRvZXNuXFwncyBleGlzdCcpXG5cbiAgICBpZiAoIXVzZXIubGFuZHMuaW5jbHVkZXMobGFuZElkKSkgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGxhbmQgZG9lc25cXCd0IGJlbG9uZyB0byB0aGlzIHVzZXInKVxuXG4gICAgbGFuZC5wbGFudGF0aW9uLmZvckVhY2gocGxhbnRhdGlvbiA9PiB7XG4gICAgICAgIGRlbGV0ZSBwbGFudGF0aW9uLl9pZFxuICAgICAgICBwbGFudGF0aW9uLnRvID0gbW9tZW50KHBsYW50YXRpb24udG8pLmZvcm1hdCgnWVlZWS1NTS1ERCcpXG4gICAgICAgIHBsYW50YXRpb24uZnJvbSA9IG1vbWVudChwbGFudGF0aW9uLmZyb20pLmZvcm1hdCgnWVlZWS1NTS1ERCcpXG4gICAgfSlcblxuICAgIGNvbnNvbGUubG9nKGxhbmQucGxhbnRhdGlvbilcblxuICAgIHJldHVybiBsYW5kLnBsYW50YXRpb25cbn0iXX0=