function cov_17hz02bljt(){var path="/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/search-items.js";var hash="c8575ab2798156a54c34ecfc95903bddd2664cb1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/search-items.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:43}},"1":{start:{line:2,column:29},end:{line:2,column:50}},"2":{start:{line:3,column:26},end:{line:3,column:55}},"3":{start:{line:5,column:0},end:{line:35,column:1}},"4":{start:{line:6,column:4},end:{line:6,column:35}},"5":{start:{line:8,column:4},end:{line:8,column:31}},"6":{start:{line:10,column:18},end:{line:10,column:344}},"7":{start:{line:12,column:4},end:{line:12,column:91}},"8":{start:{line:12,column:25},end:{line:12,column:91}},"9":{start:{line:14,column:4},end:{line:31,column:7}},"10":{start:{line:16,column:8},end:{line:30,column:9}},"11":{start:{line:33,column:4},end:{line:33,column:18}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:5,column:17},end:{line:5,column:18}},loc:{start:{line:5,column:34},end:{line:35,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:14,column:44},end:{line:14,column:45}},loc:{start:{line:14,column:54},end:{line:31,column:5}},line:14}},branchMap:{"0":{loc:{start:{line:12,column:4},end:{line:12,column:91}},type:"if",locations:[{start:{line:12,column:4},end:{line:12,column:91}},{start:{line:12,column:4},end:{line:12,column:91}}],line:12}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},f:{"0":0,"1":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c8575ab2798156a54c34ecfc95903bddd2664cb1"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_17hz02bljt=function(){return actualCoverage;};return actualCoverage;}cov_17hz02bljt();const{validate}=(cov_17hz02bljt().s[0]++,require('hoort-utils'));const{models:{Item}}=(cov_17hz02bljt().s[1]++,require('hoort-data'));const{NotFoundError}=(cov_17hz02bljt().s[2]++,require('../../hoort-errors'));cov_17hz02bljt().s[3]++;module.exports=async query=>{cov_17hz02bljt().f[0]++;cov_17hz02bljt().s[4]++;validate.string(query,'query');cov_17hz02bljt().s[5]++;query=query.toLowerCase();let results=(cov_17hz02bljt().s[6]++,await Item.find({$or:[{name:{$regex:query}},{type:{$regex:query}},{subtype:{$regex:query}},{growth:{$regex:query}},{growthDuration:{$regex:query}},{soil:{$regex:query}},{bestPeriod:{$regex:query}},{temperature:{$regex:query}},{lightPreference:{$regex:query}}]}));cov_17hz02bljt().s[7]++;if(!results.length){cov_17hz02bljt().b[0][0]++;cov_17hz02bljt().s[8]++;throw new NotFoundError('There are no results for your search :(');}else{cov_17hz02bljt().b[0][1]++;}cov_17hz02bljt().s[9]++;results=await Promise.all(results.map(result=>{cov_17hz02bljt().f[1]++;cov_17hz02bljt().s[10]++;return{id:result._id.toString(),colorId:result.colorId,name:result.name,type:result.type,subtype:result.subtype,growth:result.growth,growthDuration:result.growthDuration,soil:result.soil,temperature:result.temperature,bestPeriod:result.bestPeriod,bestPeriodNum:result.bestPeriodNum,lightPreference:result.lightPreference,growthDurationAll:result.growthDurationAll};}));cov_17hz02bljt().s[11]++;return results;};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlYXJjaC1pdGVtcy5qcyJdLCJuYW1lcyI6WyJ2YWxpZGF0ZSIsInJlcXVpcmUiLCJtb2RlbHMiLCJJdGVtIiwiTm90Rm91bmRFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJxdWVyeSIsInN0cmluZyIsInRvTG93ZXJDYXNlIiwicmVzdWx0cyIsImZpbmQiLCIkb3IiLCJuYW1lIiwiJHJlZ2V4IiwidHlwZSIsInN1YnR5cGUiLCJncm93dGgiLCJncm93dGhEdXJhdGlvbiIsInNvaWwiLCJiZXN0UGVyaW9kIiwidGVtcGVyYXR1cmUiLCJsaWdodFByZWZlcmVuY2UiLCJsZW5ndGgiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwicmVzdWx0IiwiaWQiLCJfaWQiLCJ0b1N0cmluZyIsImNvbG9ySWQiLCJiZXN0UGVyaW9kTnVtIiwiZ3Jvd3RoRHVyYXRpb25BbGwiXSwibWFwcGluZ3MiOiJvK0RBQUEsS0FBTSxDQUFFQSxRQUFGLDJCQUFlQyxPQUFPLENBQUMsYUFBRCxDQUF0QixDQUFOLENBQ0EsS0FBTSxDQUFFQyxNQUFNLENBQUUsQ0FBRUMsSUFBRixDQUFWLDJCQUF1QkYsT0FBTyxDQUFDLFlBQUQsQ0FBOUIsQ0FBTixDQUNBLEtBQU0sQ0FBRUcsYUFBRiwyQkFBb0JILE9BQU8sQ0FBQyxvQkFBRCxDQUEzQixDQUFOLEMsd0JBRUFJLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixLQUFPQyxDQUFBQSxLQUFQLEVBQWlCLGlEQUM5QlAsUUFBUSxDQUFDUSxNQUFULENBQWdCRCxLQUFoQixDQUF1QixPQUF2QixFQUQ4Qix3QkFHOUJBLEtBQUssQ0FBR0EsS0FBSyxDQUFDRSxXQUFOLEVBQVIsQ0FFQSxHQUFJQyxDQUFBQSxPQUFPLDBCQUFHLEtBQU1QLENBQUFBLElBQUksQ0FBQ1EsSUFBTCxDQUFVLENBQUVDLEdBQUcsQ0FBRSxDQUFDLENBQUVDLElBQUksQ0FBRSxDQUFFQyxNQUFNLENBQUVQLEtBQVYsQ0FBUixDQUFELENBQThCLENBQUVRLElBQUksQ0FBRSxDQUFFRCxNQUFNLENBQUVQLEtBQVYsQ0FBUixDQUE5QixDQUEyRCxDQUFFUyxPQUFPLENBQUUsQ0FBRUYsTUFBTSxDQUFFUCxLQUFWLENBQVgsQ0FBM0QsQ0FBMkYsQ0FBRVUsTUFBTSxDQUFFLENBQUVILE1BQU0sQ0FBRVAsS0FBVixDQUFWLENBQTNGLENBQTBILENBQUVXLGNBQWMsQ0FBRSxDQUFFSixNQUFNLENBQUVQLEtBQVYsQ0FBbEIsQ0FBMUgsQ0FBaUssQ0FBRVksSUFBSSxDQUFFLENBQUVMLE1BQU0sQ0FBRVAsS0FBVixDQUFSLENBQWpLLENBQThMLENBQUVhLFVBQVUsQ0FBRSxDQUFFTixNQUFNLENBQUVQLEtBQVYsQ0FBZCxDQUE5TCxDQUFpTyxDQUFFYyxXQUFXLENBQUUsQ0FBRVAsTUFBTSxDQUFFUCxLQUFWLENBQWYsQ0FBak8sQ0FBcVEsQ0FBRWUsZUFBZSxDQUFFLENBQUVSLE1BQU0sQ0FBRVAsS0FBVixDQUFuQixDQUFyUSxDQUFQLENBQVYsQ0FBVCxDQUFYLENBTDhCLHdCQU85QixHQUFJLENBQUNHLE9BQU8sQ0FBQ2EsTUFBYixDQUFxQix5REFBTSxJQUFJbkIsQ0FBQUEsYUFBSixDQUFrQix5Q0FBbEIsQ0FBTixDQUFrRSxDQUF2RixpQ0FQOEIsd0JBUzlCTSxPQUFPLENBQUcsS0FBTWMsQ0FBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlmLE9BQU8sQ0FBQ2dCLEdBQVIsQ0FBWUMsTUFBTSxFQUFJLGtEQUU5QyxNQUFPLENBQ0hDLEVBQUUsQ0FBRUQsTUFBTSxDQUFDRSxHQUFQLENBQVdDLFFBQVgsRUFERCxDQUVIQyxPQUFPLENBQUVKLE1BQU0sQ0FBQ0ksT0FGYixDQUdIbEIsSUFBSSxDQUFFYyxNQUFNLENBQUNkLElBSFYsQ0FJSEUsSUFBSSxDQUFFWSxNQUFNLENBQUNaLElBSlYsQ0FLSEMsT0FBTyxDQUFFVyxNQUFNLENBQUNYLE9BTGIsQ0FNSEMsTUFBTSxDQUFFVSxNQUFNLENBQUNWLE1BTlosQ0FPSEMsY0FBYyxDQUFFUyxNQUFNLENBQUNULGNBUHBCLENBUUhDLElBQUksQ0FBRVEsTUFBTSxDQUFDUixJQVJWLENBU0hFLFdBQVcsQ0FBRU0sTUFBTSxDQUFDTixXQVRqQixDQVVIRCxVQUFVLENBQUVPLE1BQU0sQ0FBQ1AsVUFWaEIsQ0FXSFksYUFBYSxDQUFFTCxNQUFNLENBQUNLLGFBWG5CLENBWUhWLGVBQWUsQ0FBRUssTUFBTSxDQUFDTCxlQVpyQixDQWFIVyxpQkFBaUIsQ0FBRU4sTUFBTSxDQUFDTSxpQkFidkIsQ0FBUCxDQWVILENBakIyQixDQUFaLENBQWhCLENBVDhCLHlCQTRCOUIsTUFBT3ZCLENBQUFBLE9BQVAsQ0FFSCxDQTlCRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgdmFsaWRhdGUgfSA9IHJlcXVpcmUoJ2hvb3J0LXV0aWxzJylcbmNvbnN0IHsgbW9kZWxzOiB7IEl0ZW0gfSB9ID0gcmVxdWlyZSgnaG9vcnQtZGF0YScpXG5jb25zdCB7IE5vdEZvdW5kRXJyb3IgfSA9IHJlcXVpcmUoJy4uLy4uL2hvb3J0LWVycm9ycycpXG5cbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgKHF1ZXJ5KSA9PiB7XG4gICAgdmFsaWRhdGUuc3RyaW5nKHF1ZXJ5LCAncXVlcnknKVxuXG4gICAgcXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpXG5cbiAgICBsZXQgcmVzdWx0cyA9IGF3YWl0IEl0ZW0uZmluZCh7ICRvcjogW3sgbmFtZTogeyAkcmVnZXg6IHF1ZXJ5IH0gfSwgeyB0eXBlOiB7ICRyZWdleDogcXVlcnkgfSB9LCB7IHN1YnR5cGU6IHsgJHJlZ2V4OiBxdWVyeSB9IH0sIHsgZ3Jvd3RoOiB7ICRyZWdleDogcXVlcnkgfSB9LCB7IGdyb3d0aER1cmF0aW9uOiB7ICRyZWdleDogcXVlcnkgfSB9LCB7IHNvaWw6IHsgJHJlZ2V4OiBxdWVyeSB9IH0sIHsgYmVzdFBlcmlvZDogeyAkcmVnZXg6IHF1ZXJ5IH0gfSwgeyB0ZW1wZXJhdHVyZTogeyAkcmVnZXg6IHF1ZXJ5IH0gfSwgeyBsaWdodFByZWZlcmVuY2U6IHsgJHJlZ2V4OiBxdWVyeSB9IH1dIH0pXG5cbiAgICBpZiAoIXJlc3VsdHMubGVuZ3RoKSB0aHJvdyBuZXcgTm90Rm91bmRFcnJvcignVGhlcmUgYXJlIG5vIHJlc3VsdHMgZm9yIHlvdXIgc2VhcmNoIDooJylcblxuICAgIHJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChyZXN1bHRzLm1hcChyZXN1bHQgPT4ge1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogcmVzdWx0Ll9pZC50b1N0cmluZygpLFxuICAgICAgICAgICAgY29sb3JJZDogcmVzdWx0LmNvbG9ySWQsXG4gICAgICAgICAgICBuYW1lOiByZXN1bHQubmFtZSxcbiAgICAgICAgICAgIHR5cGU6IHJlc3VsdC50eXBlLFxuICAgICAgICAgICAgc3VidHlwZTogcmVzdWx0LnN1YnR5cGUsXG4gICAgICAgICAgICBncm93dGg6IHJlc3VsdC5ncm93dGgsXG4gICAgICAgICAgICBncm93dGhEdXJhdGlvbjogcmVzdWx0Lmdyb3d0aER1cmF0aW9uLFxuICAgICAgICAgICAgc29pbDogcmVzdWx0LnNvaWwsXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogcmVzdWx0LnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgYmVzdFBlcmlvZDogcmVzdWx0LmJlc3RQZXJpb2QsXG4gICAgICAgICAgICBiZXN0UGVyaW9kTnVtOiByZXN1bHQuYmVzdFBlcmlvZE51bSxcbiAgICAgICAgICAgIGxpZ2h0UHJlZmVyZW5jZTogcmVzdWx0LmxpZ2h0UHJlZmVyZW5jZSxcbiAgICAgICAgICAgIGdyb3d0aER1cmF0aW9uQWxsOiByZXN1bHQuZ3Jvd3RoRHVyYXRpb25BbGxcbiAgICAgICAgfVxuICAgIH0pKVxuXG4gICAgcmV0dXJuIHJlc3VsdHNcblxufSJdfQ==