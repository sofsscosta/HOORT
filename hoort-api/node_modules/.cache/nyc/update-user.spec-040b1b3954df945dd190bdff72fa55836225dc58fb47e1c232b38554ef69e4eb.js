function cov_3jbdqqesc(){var path="/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/update-user.spec.js";var hash="ce567775eccd6e971ef0a77248f22d707e1caa0b";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/So/bootcamp/collab/skylab-bootcamp-202001/staff/sofia-costa/hoort/hoort-api/logic/update-user.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:38},end:{line:3,column:45}},"2":{start:{line:4,column:23},end:{line:4,column:35}},"3":{start:{line:5,column:13},end:{line:5,column:28}},"4":{start:{line:6,column:21},end:{line:6,column:42}},"5":{start:{line:7,column:29},end:{line:7,column:50}},"6":{start:{line:8,column:15},end:{line:8,column:26}},"7":{start:{line:9,column:43},end:{line:9,column:66}},"8":{start:{line:10,column:15},end:{line:10,column:34}},"9":{start:{line:12,column:0},end:{line:106,column:2}},"10":{start:{line:15,column:4},end:{line:17,column:6}},"11":{start:{line:16,column:8},end:{line:16,column:95}},"12":{start:{line:19,column:4},end:{line:30,column:6}},"13":{start:{line:20,column:8},end:{line:20,column:38}},"14":{start:{line:21,column:8},end:{line:21,column:46}},"15":{start:{line:22,column:8},end:{line:22,column:43}},"16":{start:{line:23,column:8},end:{line:23,column:46}},"17":{start:{line:25,column:8},end:{line:29,column:39}},"18":{start:{line:27,column:16},end:{line:27,column:64}},"19":{start:{line:29,column:26},end:{line:29,column:38}},"20":{start:{line:32,column:4},end:{line:52,column:6}},"21":{start:{line:35,column:8},end:{line:35,column:39}},"22":{start:{line:36,column:8},end:{line:36,column:47}},"23":{start:{line:37,column:8},end:{line:37,column:44}},"24":{start:{line:38,column:8},end:{line:38,column:47}},"25":{start:{line:40,column:8},end:{line:51,column:14}},"26":{start:{line:41,column:24},end:{line:41,column:41}},"27":{start:{line:43,column:16},end:{line:43,column:47}},"28":{start:{line:44,column:16},end:{line:44,column:55}},"29":{start:{line:45,column:16},end:{line:45,column:49}},"30":{start:{line:47,column:16},end:{line:50,column:22}},"31":{start:{line:49,column:24},end:{line:49,column:50}},"32":{start:{line:54,column:4},end:{line:72,column:6}},"33":{start:{line:57,column:8},end:{line:57,column:47}},"34":{start:{line:58,column:8},end:{line:58,column:47}},"35":{start:{line:60,column:8},end:{line:71,column:14}},"36":{start:{line:61,column:24},end:{line:61,column:41}},"37":{start:{line:63,column:16},end:{line:63,column:46}},"38":{start:{line:64,column:16},end:{line:64,column:55}},"39":{start:{line:65,column:16},end:{line:65,column:48}},"40":{start:{line:67,column:16},end:{line:70,column:22}},"41":{start:{line:69,column:24},end:{line:69,column:50}},"42":{start:{line:74,column:4},end:{line:83,column:6}},"43":{start:{line:76,column:25},end:{line:76,column:55}},"44":{start:{line:78,column:8},end:{line:82,column:14}},"45":{start:{line:79,column:26},end:{line:79,column:72}},"46":{start:{line:81,column:16},end:{line:81,column:72}},"47":{start:{line:85,column:4},end:{line:96,column:6}},"48":{start:{line:88,column:8},end:{line:88,column:22}},"49":{start:{line:89,column:8},end:{line:89,column:47}},"50":{start:{line:91,column:8},end:{line:95,column:14}},"51":{start:{line:92,column:26},end:{line:92,column:72}},"52":{start:{line:94,column:16},end:{line:94,column:71}},"53":{start:{line:98,column:4},end:{line:100,column:6}},"54":{start:{line:99,column:8},end:{line:99,column:34}},"55":{start:{line:102,column:4},end:{line:104,column:6}},"56":{start:{line:103,column:8},end:{line:103,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:23},end:{line:12,column:24}},loc:{start:{line:12,column:29},end:{line:106,column:1}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:11},end:{line:15,column:12}},loc:{start:{line:15,column:17},end:{line:17,column:5}},line:15},"2":{name:"(anonymous_2)",decl:{start:{line:19,column:15},end:{line:19,column:16}},loc:{start:{line:19,column:21},end:{line:30,column:5}},line:19},"3":{name:"(anonymous_3)",decl:{start:{line:26,column:18},end:{line:26,column:19}},loc:{start:{line:27,column:16},end:{line:27,column:64}},line:27},"4":{name:"(anonymous_4)",decl:{start:{line:29,column:18},end:{line:29,column:19}},loc:{start:{line:29,column:26},end:{line:29,column:38}},line:29},"5":{name:"(anonymous_5)",decl:{start:{line:32,column:72},end:{line:32,column:73}},loc:{start:{line:32,column:78},end:{line:52,column:5}},line:32},"6":{name:"(anonymous_6)",decl:{start:{line:41,column:18},end:{line:41,column:19}},loc:{start:{line:41,column:24},end:{line:41,column:41}},line:41},"7":{name:"(anonymous_7)",decl:{start:{line:42,column:18},end:{line:42,column:19}},loc:{start:{line:42,column:26},end:{line:51,column:13}},line:42},"8":{name:"(anonymous_8)",decl:{start:{line:48,column:26},end:{line:48,column:27}},loc:{start:{line:48,column:37},end:{line:50,column:21}},line:48},"9":{name:"(anonymous_9)",decl:{start:{line:54,column:51},end:{line:54,column:52}},loc:{start:{line:54,column:57},end:{line:72,column:5}},line:54},"10":{name:"(anonymous_10)",decl:{start:{line:61,column:18},end:{line:61,column:19}},loc:{start:{line:61,column:24},end:{line:61,column:41}},line:61},"11":{name:"(anonymous_11)",decl:{start:{line:62,column:18},end:{line:62,column:19}},loc:{start:{line:62,column:26},end:{line:71,column:13}},line:62},"12":{name:"(anonymous_12)",decl:{start:{line:68,column:26},end:{line:68,column:27}},loc:{start:{line:68,column:37},end:{line:70,column:21}},line:68},"13":{name:"(anonymous_13)",decl:{start:{line:74,column:51},end:{line:74,column:52}},loc:{start:{line:74,column:57},end:{line:83,column:5}},line:74},"14":{name:"(anonymous_14)",decl:{start:{line:79,column:18},end:{line:79,column:19}},loc:{start:{line:79,column:24},end:{line:79,column:74}},line:79},"15":{name:"(anonymous_15)",decl:{start:{line:80,column:19},end:{line:80,column:20}},loc:{start:{line:80,column:28},end:{line:82,column:13}},line:80},"16":{name:"(anonymous_16)",decl:{start:{line:85,column:42},end:{line:85,column:43}},loc:{start:{line:85,column:48},end:{line:96,column:5}},line:85},"17":{name:"(anonymous_17)",decl:{start:{line:92,column:18},end:{line:92,column:19}},loc:{start:{line:92,column:24},end:{line:92,column:74}},line:92},"18":{name:"(anonymous_18)",decl:{start:{line:93,column:19},end:{line:93,column:20}},loc:{start:{line:93,column:28},end:{line:95,column:13}},line:93},"19":{name:"(anonymous_19)",decl:{start:{line:98,column:14},end:{line:98,column:15}},loc:{start:{line:98,column:20},end:{line:100,column:5}},line:98},"20":{name:"(anonymous_20)",decl:{start:{line:102,column:10},end:{line:102,column:11}},loc:{start:{line:102,column:16},end:{line:104,column:5}},line:102}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ce567775eccd6e971ef0a77248f22d707e1caa0b"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_3jbdqqesc=function(){return actualCoverage;};return actualCoverage;}cov_3jbdqqesc();cov_3jbdqqesc().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL}}=(cov_3jbdqqesc().s[1]++,process);const{updateUser}=(cov_3jbdqqesc().s[2]++,require('.'));const chai=(cov_3jbdqqesc().s[3]++,require('chai'));const{mongoose}=(cov_3jbdqqesc().s[4]++,require('hoort-data'));const{models:{User}}=(cov_3jbdqqesc().s[5]++,require('hoort-data'));const expect=(cov_3jbdqqesc().s[6]++,chai.expect);const{NotFoundError,NotAllowedError}=(cov_3jbdqqesc().s[7]++,require('hoort-errors'));const bcrypt=(cov_3jbdqqesc().s[8]++,require('bcryptjs'));cov_3jbdqqesc().s[9]++;describe('updateUser',()=>{cov_3jbdqqesc().f[0]++;let name,username,email,password,id;cov_3jbdqqesc().s[10]++;before(()=>{cov_3jbdqqesc().f[1]++;cov_3jbdqqesc().s[11]++;mongoose.connect(TEST_MONGODB_URL,{useNewUrlParser:true,useUnifiedTopology:true});});cov_3jbdqqesc().s[12]++;beforeEach(()=>{cov_3jbdqqesc().f[2]++;cov_3jbdqqesc().s[13]++;name='name-'+Math.random();cov_3jbdqqesc().s[14]++;username='username-'+Math.random();cov_3jbdqqesc().s[15]++;email=Math.random()+'@mail.com';cov_3jbdqqesc().s[16]++;password='password-'+Math.random();cov_3jbdqqesc().s[17]++;return bcrypt.hash(password,10).then(password=>{cov_3jbdqqesc().f[3]++;cov_3jbdqqesc().s[18]++;return User.create({name,username,email,password});}).then(user=>{cov_3jbdqqesc().f[4]++;cov_3jbdqqesc().s[19]++;return id=user.id;});});cov_3jbdqqesc().s[20]++;it('should succeed on correct data and all possible fields passed',()=>{cov_3jbdqqesc().f[5]++;let name1,username1,email1,password1;cov_3jbdqqesc().s[21]++;name1='name-'+Math.random();cov_3jbdqqesc().s[22]++;username1='username-'+Math.random();cov_3jbdqqesc().s[23]++;email1=Math.random()+'@mail.com';cov_3jbdqqesc().s[24]++;password1='password-'+Math.random();cov_3jbdqqesc().s[25]++;return updateUser(id,{name:name1,username:username1,email:email1,password:password1}).then(()=>{cov_3jbdqqesc().f[6]++;cov_3jbdqqesc().s[26]++;return User.findById(id);}).then(user=>{cov_3jbdqqesc().f[7]++;cov_3jbdqqesc().s[27]++;expect(user.name).to.eql(name1);cov_3jbdqqesc().s[28]++;expect(user.username).to.eql(username1);cov_3jbdqqesc().s[29]++;expect(user.email).to.eql(email1);cov_3jbdqqesc().s[30]++;return bcrypt.compare(password1,user.password).then(isValid=>{cov_3jbdqqesc().f[8]++;cov_3jbdqqesc().s[31]++;expect(isValid).to.be.true;});});});cov_3jbdqqesc().s[32]++;it('should succeed if some fields are passed',()=>{cov_3jbdqqesc().f[9]++;let username1,password1;cov_3jbdqqesc().s[33]++;username1='username-'+Math.random();cov_3jbdqqesc().s[34]++;password1='password-'+Math.random();cov_3jbdqqesc().s[35]++;return updateUser(id,{username:username1,password:password1}).then(()=>{cov_3jbdqqesc().f[10]++;cov_3jbdqqesc().s[36]++;return User.findById(id);}).then(user=>{cov_3jbdqqesc().f[11]++;cov_3jbdqqesc().s[37]++;expect(user.name).to.eql(name);cov_3jbdqqesc().s[38]++;expect(user.username).to.eql(username1);cov_3jbdqqesc().s[39]++;expect(user.email).to.eql(email);cov_3jbdqqesc().s[40]++;return bcrypt.compare(password1,user.password).then(isValid=>{cov_3jbdqqesc().f[12]++;cov_3jbdqqesc().s[41]++;expect(isValid).to.be.true;});});});cov_3jbdqqesc().s[42]++;it('should fail if invalid fields are passed',()=>{cov_3jbdqqesc().f[13]++;let wrongField=(cov_3jbdqqesc().s[43]++,'wrong-field-'+Math.random());cov_3jbdqqesc().s[44]++;return updateUser(id,{wrongField}).then(()=>{cov_3jbdqqesc().f[14]++;cov_3jbdqqesc().s[45]++;throw new Error('should not reach this point');}).catch(error=>{cov_3jbdqqesc().f[15]++;cov_3jbdqqesc().s[46]++;expect(error.message).to.eql(`invalid field wrongField`);});});cov_3jbdqqesc().s[47]++;it('should fail if a field is empty',()=>{cov_3jbdqqesc().f[16]++;let username1,password1;cov_3jbdqqesc().s[48]++;username1='';cov_3jbdqqesc().s[49]++;password1='password-'+Math.random();cov_3jbdqqesc().s[50]++;return updateUser(id,{username:username1,password:password1}).then(()=>{cov_3jbdqqesc().f[17]++;cov_3jbdqqesc().s[51]++;throw new Error('should not reach this point');}).catch(error=>{cov_3jbdqqesc().f[18]++;cov_3jbdqqesc().s[52]++;expect(error.message).to.eql(`field username is empty`);});});cov_3jbdqqesc().s[53]++;afterEach(()=>{cov_3jbdqqesc().f[19]++;cov_3jbdqqesc().s[54]++;User.findByIdAndRemove(id);});cov_3jbdqqesc().s[55]++;after(()=>{cov_3jbdqqesc().f[20]++;cov_3jbdqqesc().s[56]++;mongoose.disconnect();});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwZGF0ZS11c2VyLnNwZWMuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImNvbmZpZyIsImVudiIsIlRFU1RfTU9OR09EQl9VUkwiLCJwcm9jZXNzIiwidXBkYXRlVXNlciIsImNoYWkiLCJtb25nb29zZSIsIm1vZGVscyIsIlVzZXIiLCJleHBlY3QiLCJOb3RGb3VuZEVycm9yIiwiTm90QWxsb3dlZEVycm9yIiwiYmNyeXB0IiwiZGVzY3JpYmUiLCJuYW1lIiwidXNlcm5hbWUiLCJlbWFpbCIsInBhc3N3b3JkIiwiaWQiLCJiZWZvcmUiLCJjb25uZWN0IiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwiYmVmb3JlRWFjaCIsIk1hdGgiLCJyYW5kb20iLCJoYXNoIiwidGhlbiIsImNyZWF0ZSIsInVzZXIiLCJpdCIsIm5hbWUxIiwidXNlcm5hbWUxIiwiZW1haWwxIiwicGFzc3dvcmQxIiwiZmluZEJ5SWQiLCJ0byIsImVxbCIsImNvbXBhcmUiLCJpc1ZhbGlkIiwiYmUiLCJ0cnVlIiwid3JvbmdGaWVsZCIsIkVycm9yIiwiY2F0Y2giLCJlcnJvciIsIm1lc3NhZ2UiLCJhZnRlckVhY2giLCJmaW5kQnlJZEFuZFJlbW92ZSIsImFmdGVyIiwiZGlzY29ubmVjdCJdLCJtYXBwaW5ncyI6IjYrT0FBQUEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQkMsTUFBbEIsR0FFQSxLQUFNLENBQUVDLEdBQUcsQ0FBRSxDQUFFQyxnQkFBRixDQUFQLDBCQUFnQ0MsT0FBaEMsQ0FBTixDQUNBLEtBQU0sQ0FBRUMsVUFBRiwwQkFBaUJMLE9BQU8sQ0FBQyxHQUFELENBQXhCLENBQU4sQ0FDQSxLQUFNTSxDQUFBQSxJQUFJLHlCQUFHTixPQUFPLENBQUMsTUFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNLENBQUVPLFFBQUYsMEJBQWVQLE9BQU8sQ0FBQyxZQUFELENBQXRCLENBQU4sQ0FDQSxLQUFNLENBQUVRLE1BQU0sQ0FBRSxDQUFFQyxJQUFGLENBQVYs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Q0FEM0QsRUFFRkMsS0FGRSxDQUVJQyxLQUFLLEVBQUksaURBQ1pwQyxNQUFNLENBQUNvQyxLQUFLLENBQUNDLE9BQVAsQ0FBTixDQUFzQlYsRUFBdEIsQ0FBeUJDLEdBQXpCLENBQThCLHlCQUE5QixFQUNILENBSkUsQ0FBUCxDQUtILENBWEMsQ0FBRixDQXpFeUIsd0JBc0Z6QlUsU0FBUyxDQUFDLElBQU0saURBQ1p2QyxJQUFJLENBQUN3QyxpQkFBTCxDQUF1QjlCLEVBQXZCLEVBQ0gsQ0FGUSxDQUFULENBdEZ5Qix3QkEwRnpCK0IsS0FBSyxDQUFDLElBQU0saURBQ1IzQyxRQUFRLENBQUM0QyxVQUFULEdBQ0gsQ0FGSSxDQUFMLENBSUgsQ0E5Rk8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpXG5cbmNvbnN0IHsgZW52OiB7IFRFU1RfTU9OR09EQl9VUkwgfSB9ID0gcHJvY2Vzc1xuY29uc3QgeyB1cGRhdGVVc2VyIH0gPSByZXF1aXJlKCcuJylcbmNvbnN0IGNoYWkgPSByZXF1aXJlKCdjaGFpJylcbmNvbnN0IHsgbW9uZ29vc2UgfSA9IHJlcXVpcmUoJ2hvb3J0LWRhdGEnKVxuY29uc3QgeyBtb2RlbHM6IHsgVXNlciB9IH0gPSByZXF1aXJlKCdob29ydC1kYXRhJylcbmNvbnN0IGV4cGVjdCA9IGNoYWkuZXhwZWN0XG5jb25zdCB7IE5vdEZvdW5kRXJyb3IsIE5vdEFsbG93ZWRFcnJvciB9ID0gcmVxdWlyZSgnaG9vcnQtZXJyb3JzJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdGpzJylcblxuZGVzY3JpYmUoJ3VwZGF0ZVVzZXInLCAoKSA9PiB7XG4gICAgbGV0IG5hbWUsIHVzZXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQsIGlkXG5cbiAgICBiZWZvcmUoKCkgPT4ge1xuICAgICAgICBtb25nb29zZS5jb25uZWN0KFRFU1RfTU9OR09EQl9VUkwsIHsgdXNlTmV3VXJsUGFyc2VyOiB0cnVlLCB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWUgfSlcbiAgICB9KVxuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgIG5hbWUgPSAnbmFtZS0nICsgTWF0aC5yYW5kb20oKVxuICAgICAgICB1c2VybmFtZSA9ICd1c2VybmFtZS0nICsgTWF0aC5yYW5kb20oKVxuICAgICAgICBlbWFpbCA9IE1hdGgucmFuZG9tKCkgKyAnQG1haWwuY29tJ1xuICAgICAgICBwYXNzd29yZCA9ICdwYXNzd29yZC0nICsgTWF0aC5yYW5kb20oKVxuXG4gICAgICAgIHJldHVybiBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTApXG4gICAgICAgICAgICAudGhlbihwYXNzd29yZCA9PlxuICAgICAgICAgICAgICAgIFVzZXIuY3JlYXRlKHsgbmFtZSwgdXNlcm5hbWUsIGVtYWlsLCBwYXNzd29yZCB9KVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLnRoZW4odXNlciA9PiBpZCA9IHVzZXIuaWQpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgc3VjY2VlZCBvbiBjb3JyZWN0IGRhdGEgYW5kIGFsbCBwb3NzaWJsZSBmaWVsZHMgcGFzc2VkJywgKCkgPT4ge1xuICAgICAgICBsZXQgbmFtZTEsIHVzZXJuYW1lMSwgZW1haWwxLCBwYXNzd29yZDFcblxuICAgICAgICBuYW1lMSA9ICduYW1lLScgKyBNYXRoLnJhbmRvbSgpXG4gICAgICAgIHVzZXJuYW1lMSA9ICd1c2VybmFtZS0nICsgTWF0aC5yYW5kb20oKVxuICAgICAgICBlbWFpbDEgPSBNYXRoLnJhbmRvbSgpICsgJ0BtYWlsLmNvbSdcbiAgICAgICAgcGFzc3dvcmQxID0gJ3Bhc3N3b3JkLScgKyBNYXRoLnJhbmRvbSgpXG5cbiAgICAgICAgcmV0dXJuIHVwZGF0ZVVzZXIoaWQsIHsgbmFtZTogbmFtZTEsIHVzZXJuYW1lOiB1c2VybmFtZTEsIGVtYWlsOiBlbWFpbDEsIHBhc3N3b3JkOiBwYXNzd29yZDEgfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IFVzZXIuZmluZEJ5SWQoaWQpKVxuICAgICAgICAgICAgLnRoZW4odXNlciA9PiB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHVzZXIubmFtZSkudG8uZXFsKG5hbWUxKVxuICAgICAgICAgICAgICAgIGV4cGVjdCh1c2VyLnVzZXJuYW1lKS50by5lcWwodXNlcm5hbWUxKVxuICAgICAgICAgICAgICAgIGV4cGVjdCh1c2VyLmVtYWlsKS50by5lcWwoZW1haWwxKVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkMSwgdXNlci5wYXNzd29yZClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oaXNWYWxpZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoaXNWYWxpZCkudG8uYmUudHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICB9KVxuXG4gICAgaXQoJ3Nob3VsZCBzdWNjZWVkIGlmIHNvbWUgZmllbGRzIGFyZSBwYXNzZWQnLCAoKSA9PiB7XG4gICAgICAgIGxldCB1c2VybmFtZTEsIHBhc3N3b3JkMVxuXG4gICAgICAgIHVzZXJuYW1lMSA9ICd1c2VybmFtZS0nICsgTWF0aC5yYW5kb20oKVxuICAgICAgICBwYXNzd29yZDEgPSAncGFzc3dvcmQtJyArIE1hdGgucmFuZG9tKClcblxuICAgICAgICByZXR1cm4gdXBkYXRlVXNlcihpZCwgeyB1c2VybmFtZTogdXNlcm5hbWUxLCBwYXNzd29yZDogcGFzc3dvcmQxIH0pXG4gICAgICAgICAgICAudGhlbigoKSA9PiBVc2VyLmZpbmRCeUlkKGlkKSlcbiAgICAgICAgICAgIC50aGVuKHVzZXIgPT4ge1xuICAgICAgICAgICAgICAgIGV4cGVjdCh1c2VyLm5hbWUpLnRvLmVxbChuYW1lKVxuICAgICAgICAgICAgICAgIGV4cGVjdCh1c2VyLnVzZXJuYW1lKS50by5lcWwodXNlcm5hbWUxKVxuICAgICAgICAgICAgICAgIGV4cGVjdCh1c2VyLmVtYWlsKS50by5lcWwoZW1haWwpXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQxLCB1c2VyLnBhc3N3b3JkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihpc1ZhbGlkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChpc1ZhbGlkKS50by5iZS50cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgIH0pXG5cbiAgICBpdCgnc2hvdWxkIGZhaWwgaWYgaW52YWxpZCBmaWVsZHMgYXJlIHBhc3NlZCcsICgpID0+IHtcblxuICAgICAgICBsZXQgd3JvbmdGaWVsZCA9ICd3cm9uZy1maWVsZC0nICsgTWF0aC5yYW5kb20oKVxuXG4gICAgICAgIHJldHVybiB1cGRhdGVVc2VyKGlkLCB7IHdyb25nRmllbGQgfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdzaG91bGQgbm90IHJlYWNoIHRoaXMgcG9pbnQnKSB9KVxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG8uZXFsKGBpbnZhbGlkIGZpZWxkIHdyb25nRmllbGRgKVxuICAgICAgICAgICAgfSlcbiAgICB9KVxuXG4gICAgaXQoJ3Nob3VsZCBmYWlsIGlmIGEgZmllbGQgaXMgZW1wdHknLCAoKSA9PiB7XG4gICAgICAgIGxldCB1c2VybmFtZTEsIHBhc3N3b3JkMVxuXG4gICAgICAgIHVzZXJuYW1lMSA9ICcnXG4gICAgICAgIHBhc3N3b3JkMSA9ICdwYXNzd29yZC0nICsgTWF0aC5yYW5kb20oKVxuXG4gICAgICAgIHJldHVybiB1cGRhdGVVc2VyKGlkLCB7IHVzZXJuYW1lOiB1c2VybmFtZTEsIHBhc3N3b3JkOiBwYXNzd29yZDEgfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdzaG91bGQgbm90IHJlYWNoIHRoaXMgcG9pbnQnKSB9KVxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG8uZXFsKGBmaWVsZCB1c2VybmFtZSBpcyBlbXB0eWApXG4gICAgICAgICAgICB9KVxuICAgIH0pXG5cbiAgICBhZnRlckVhY2goKCkgPT4ge1xuICAgICAgICBVc2VyLmZpbmRCeUlkQW5kUmVtb3ZlKGlkKVxuICAgIH0pXG5cbiAgICBhZnRlcigoKSA9PiB7XG4gICAgICAgIG1vbmdvb3NlLmRpc2Nvbm5lY3QoKVxuICAgIH0pXG5cbn0pIl19